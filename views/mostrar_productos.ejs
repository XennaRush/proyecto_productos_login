<%- include("templates/header", { titulo: titulo || "Productos" }) %>

<div class="mb-3">
  <a href="/admin/productos/nuevo" class="btn btn-primary">Agregar nuevo producto</a>
</div>

<table class="table table-striped">
  <thead>
    <tr>
      <th>Nombre</th>
      <th>Precio</th>
      <th>Stock</th>
      <th>Categoria</th>
      <th>Acciones</th>
    </tr>
  </thead>
  <tbody>
    <% if (productos.length === 0) { %>
      <tr><td colspan="5" class="text-center">No hay productos</td></tr>
    <% } %>
    <% productos.forEach(p => { %>
      <tr>
        <td><%= p.nombre %></td>
        <td>$<%= p.precio.toFixed(2) %></td>
        <td><%= p.stock %></td>
        <td><%= p.categoria %></td>
        <td>
          <a class="btn btn-sm btn-primary" href="/admin/productos/editar/<%= p._id %>">Editar</a>
          <a class="btn btn-sm btn-danger" href="/admin/productos/borrar/<%= p._id %>" onclick="return confirm('Borrar producto?')">Borrar</a>

          <!-- Formulario para aumentar stock -->
          <form action="/admin/productos/aumentarStock" method="POST" class="d-flex mt-1">
            <input type="hidden" name="idProducto" value="<%= p._id %>">
            <input type="number" name="cantidad" min="1" value="1" class="form-control form-control-sm me-2" style="width:70px;">
            <button type="submit" class="btn btn-sm btn-success">+ Stock</button>
          </form>
        </td>
      </tr>
    <% }) %>
  </tbody>
</table>

<%- include("templates/footer") %>
